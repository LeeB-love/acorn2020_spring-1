<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Step08_3dCarousel.html</title>
<style>
	.container{
		width: 80%;
		margin: 0 auto;
	}

	/* .wrapper 를 3d 공간으로 만들기 */
	.wrapper{
		perspective: 1000px;
		perspective-origin: 50% 50%;
	}
	.carousel{
		transform-style: preserve-3d;
		position: relative;
		height: 500px;
	}
	.carousel div{
		position: absolute;
		height: 400px;
		border: 1px solid red;
	}
</style>
</head>
<body>
<div class="container">
	<h1>회전하는 컨텐츠 입니다.</h1>
	<div class="wrapper">
		<div class="carousel">
			<div>
				<h3>one 컨텐츠</h3>
				<img src="../resources/images/1.jpg" width="200"/>
				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nesciunt sint labore voluptas molestias ut inventore iure eaque distinctio nam. Cum deleniti cumque id perspiciatis consectetur alias sint quam nobis eius!</p>
			</div>
			<div>
				<h3>two 컨텐츠</h3>
				<img src="../resources/images/2.jpg" width="200"/>
				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nesciunt sint labore voluptas molestias ut inventore iure eaque distinctio nam. Cum deleniti cumque id perspiciatis consectetur alias sint quam nobis eius!</p>
			</div>
			<div>
				<h3>three 컨텐츠</h3>
				<img src="../resources/images/3.jpg" width="200"/>
				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nesciunt sint labore voluptas molestias ut inventore iure eaque distinctio nam. Cum deleniti cumque id perspiciatis consectetur alias sint quam nobis eius!</p>
			</div>
			<div>
				<h3>four 컨텐츠</h3>
				<img src="../resources/images/4.jpg" width="200"/>
				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nesciunt sint labore voluptas molestias ut inventore iure eaque distinctio nam. Cum deleniti cumque id perspiciatis consectetur alias sint quam nobis eius!</p>
			</div>
			<div>
				<h3>five 컨텐츠</h3>
				<img src="../resources/images/5.jpg" width="200"/>
				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nesciunt sint labore voluptas molestias ut inventore iure eaque distinctio nam. Cum deleniti cumque id perspiciatis consectetur alias sint quam nobis eius!</p>
			</div>
		</div>
	</div>
</div>
<script src="../resources/js/jquery-3.5.1.js"></script>
<script>

	//페이지 로딩 시점에 한번 배치하기
	initCarousel();
	
	//resize 이벤트가 일어났을 떄 다시 배치하기 (창 크기 변환 시 다시 배치)
	//$(window).on("resize", function(){
	//	initCarousel();
	//})

	// .carousel 안에 있는 div 를  3d 로 배치하는 함수
	function initCarousel(){
		// .carousel 안에 있는 div 의 갯수 얻어내기
		var n=$(".carousel div").length;
		// .carousel 의 width 얻어내기
		var width=$(".carousel").width();
		// tz 와 angle 값을 가지고 있는 object 를 얻어낸다.
		var obj=getAngleNtz(n, width);
		// z 축으로 평행이동해야 하는 값
		var tz=obj.tz;
		// 회전 각도 
		var angle=obj.angle;
		
		// .carousel 을 일단 미리 뒤로 밀어 넣는다. 
		$(".carousel").css("transform","translateZ(-"+tz+"px)");
		
		//div 의 회전값을 저장할 변수 
		var tmpY=0;
		//반복문 돌면서 div 를 배치하기
		for(var i=0; i<n; i++){
			$(".carousel div").eq(i)
			.css("transform","rotateY("+tmpY+"deg) translateZ("+tz+"px)");
			tmpY += angle;
		}
	}
	
	// n 각형과 한변의 길이가 width 일때 몇도씩 돌면서 z 축방향으로 얼마만큼 평행이동하면 되는지 
	// 에 대한 정보를 담고있는 object 를 리턴하는 함수 
  	function getAngleNtz(n, width) {
	    var angle = Math.round(360 / n);
	    var tz = Math.round((width / 2) / Math.tan((angle * Math.PI) / (2 * 180)));
	    var obj = {
	      angle: angle,
	      tz: tz
	    };
	    return obj;
	 }
</script>
</body>
</html>
